<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LadyLillyLashes</title>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css' rel='stylesheet' />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js'></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: repeating-linear-gradient(
                to bottom,
                #ffe6f0, /* Różowy kolor */
                #ffe6f0 50px,
                #fff 50px,
                #fff 100px
            );
        }
        .container {
            width: 80%;
            margin: 0 auto;
            overflow: hidden;
        }
        header {
            background: #ff69b4; /* Różowy kolor */
            color: #fff;
            padding: 20px;
            display: flex;
            align-items: center;
            border-bottom: #ff1493 3px solid; /* Ciemniejszy różowy */
        }
        header a {
            color: #fff;
            text-decoration: none;
            text-transform: uppercase;
            font-size: 16px;
        }
        #branding {
            flex-grow: 1;
        }
        #branding img {
            max-height: 70px;
            margin-right: 20px;
        }
        #branding h1 {
            display: inline;
            margin: 0;
            vertical-align: middle;
        }
        nav {
            margin-top: 10px;
        }
        nav ul {
            margin: 0;
            padding: 0;
            list-style: none;
        }
        nav ul li {
            display: inline;
            margin-left: 10px;
        }
        section#showcase {
            min-height: 400px;
            background: #ff1493;
            color: #fff;
            text-align: center;
            padding-top: 100px;
        }
        section#showcase h1 {
            font-size: 55px;
            margin-top: 0;
        }
        section#showcase p {
            font-size: 20px;
        }
        #main-content {
            padding: 20px;
            background: rgba(255, 255, 255, 0.8); /* Białe tło z przezroczystością, aby widzieć pasy */
            color: #333;
        }
        footer {
            padding: 20px;
            margin-top: 20px;
            color: #fff;
            background-color: #ff69b4;
            text-align: center;
        }
        form {
            display: flex;
            flex-direction: column;
            width: 50%;
            margin: 0 auto;
        }
        form input, form select, form textarea {
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
        }
        .admin-login {
            text-align: center;
            margin: 20px 0;
        }
        .admin-login input[type="password"] {
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
        }
        .admin-login button {
            background-color: #ff1493;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .admin-section {
            display: none;
        }
        .admin-section table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .admin-section th, .admin-section td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .admin-section th {
            background-color: #ff69b4;
            color: white;
        }
        .admin-section td {
            background-color: #fff;
        }
        .admin-section .admin-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        @media (max-width: 768px) {
            .container {
                width: 90%;
            }
            header {
                flex-direction: column;
                text-align: center;
            }
            #branding img {
                margin: 0 auto;
            }
            nav ul {
                text-align: center;
                margin-top: 10px;
            }
            nav ul li {
                display: block;
                margin: 10px 0;
            }
            section#showcase h1 {
                font-size: 35px;
            }
            section#showcase p {
                font-size: 18px;
            }
            form {
                width: 100%;
            }
        }
        @media (max-width: 480px) {
            header {
                padding: 10px;
            }
            section#showcase {
                padding-top: 50px;
            }
            section#showcase h1 {
                font-size: 25px;
            }
            section#showcase p {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div id="branding">
            <!-- Dodaj adres URL swojego obrazka poniżej -->
            <img src="link-do-twojego-obrazka.jpg" alt="Logo">
            <h1>LadyLillyLashes</h1>
        </div>
        <nav>
            <ul>
                <li><a href="#showcase">Strona Główna</a></li>
                <li><a href="#calendar">Kalendarz</a></li>
                <li><a href="#contact">Kontakt</a></li>
            </ul>
        </nav>
    </header>

    <section id="showcase">
        <div class="container">
            <h1>Witamy na LadyLillyLashes</h1>
            <p>Zarezerwuj wizytę szybko i wygodnie</p>
            <div class="image-container">
                <!-- Zamień link-do-twojego-obrazka.jpg na URL swojego obrazka -->
                <img src="link-do-twojego-obrazka.jpg" alt="Opis obrazka">
            </div>
        </div>
    </section>

    <div id="main-content" class="container">
        <section id="calendar">
            <h2>Kalendarz Rezerwacji</h2>
            <div id="calendar"></div>
        </section>

        <section id="booking-form">
            <h2>Formularz Rezerwacji</h2>
            <div class="booking-form">
                <input type="text" id="name" placeholder="Imię i Nazwisko" required>
                <input type="tel" id="phone" placeholder="Numer Telefonu" required>
                <input type="email" id="email" placeholder="E-mail" required>
                <select id="service" required>
                    <option value="">Wybierz usługę</option>
                    <option value="service1">Light_Volume</option>
                    <option value="service2">Mega_Volume</option>
                    <option value="service3">Ściągnięcie_rzęs</option>
                </select>
                <input type="datetime-local" id="datetime" required>
                <textarea id="comments" placeholder="Dodatkowe uwagi"></textarea>
                <button id="add-event">Zarezerwuj</button>
            </div>
        </section>

        <section id="admin-login">
            <h2>Panel Administratora</h2>
            <div class="admin-login">
                <input type="password" id="admin-password" placeholder="Wprowadź hasło">
                <button onclick="login()">Zaloguj się</button>
            </div>
        </section>

        <section id="admin-section" class="admin-section">
            <h2>Lista Rezerwacji</h2>
            <div class="admin-actions">
                <button onclick="showAddSlotForm()">Dodaj dostępne godziny</button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Data i godzina</th>
                        <th>Imię i Nazwisko</th>
                        <th>Telefon</th>
                        <th>E-mail</th>
                        <th>Usługa</th>
                        <th>Komentarze</th>
                        <th>Akcje</th>
                    </tr>
                </thead>
                <tbody id="reservations-list">
                </tbody>
            </table>
            <div id="add-slot-form" style="display: none;">
                <h3>Dodaj dostępne godziny</h3>
                <input type="datetime-local" id="slot-datetime">
                <button onclick="addAvailableSlot()">Dodaj</button>
            </div>
        </section>
    </div>

    <footer>
        <p>LadyLillyLashes &copy; 2024</p>
    </footer>

    <script>
        const adminPassword = "TwojeHaslo"; // Zamień na swoje hasło
        let isAdmin = false;
        const reservations = [];
        const availableSlots = [];

        function login() {
            const inputPassword = document.getElementById('admin-password').value;
            if (inputPassword === adminPassword) {
                document.getElementById('admin-login').style.display = 'none';
                document.querySelector('.admin-section').style.display = 'block';
                isAdmin = true;
                fetchReservations();
            } else {
                alert('Nieprawidłowe hasło');
            }
        }

        function fetchReservations() {
            fetch('get_reservations.php')
                .then(response => response.json())
                .then(data => {
                    data.forEach(event => {
                        reservations.push({
                            title: event.name,
                            start: event.datetime
                        });
                    });
                    renderCalendar();
                    renderReservations();
                });
        }

        function renderReservations() {
            const reservationsList = document.getElementById('reservations-list');
            reservationsList.innerHTML = '';
            reservations.forEach((reservation, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${reservation.start}</td>
                    <td>${reservation.title}</td>
                    <td>${reservation.extendedProps?.phone || ''}</td>
                    <td>${reservation.extendedProps?.email || ''}</td>
                    <td>${reservation.extendedProps?.service || ''}</td>
                    <td>${reservation.extendedProps?.comments || ''}</td>
                    <td>
                        <button onclick="editReservation(${index})">Edytuj</button>
                        <button onclick="deleteReservation(${index})">Usuń</button>
                        <button onclick="sendEmail(${index}, 'accepted')">Zaakceptuj</button>
                        <button onclick="sendEmail(${index}, 'rejected')">Odrzuć</button>
                    </td>
                `;
                reservationsList.appendChild(row);
            });
        }

        function renderCalendar() {
            $('#calendar').fullCalendar({
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                editable: true,
                selectable: true,
                events: reservations,
                select: function(start, end) {
                    const title = prompt('Wprowadź swoje imię:');
                    if (title) {
                        const eventData = {
                            title: title,
                            start: start,
                            end: end,
                            extendedProps: {}
                        };
                        reservations.push(eventData);
                        $('#calendar').fullCalendar('renderEvent', eventData, true);
                        renderReservations();
                    }
                    $('#calendar').fullCalendar('unselect');
                },
                eventClick: function(event) {
                    if (isAdmin) {
                        editReservation(reservations.indexOf(event));
                    } else {
                        alert('Tylko administrator może edytować lub usuwać rezerwacje.');
                    }
                }
            });
        }

        function editReservation(index) {
            const reservation = reservations[index];
            const newTitle = prompt('Wprowadź nowe imię:', reservation.title);
            if (newTitle) {
                reservation.title = newTitle;
                $('#calendar').fullCalendar('updateEvent', reservation);
                renderReservations();
            }
        }

        function deleteReservation(index) {
            if (confirm('Czy na pewno chcesz usunąć tę rezerwację?')) {
                const reservation = reservations[index];
                $('#calendar').fullCalendar('removeEvents', reservation._id);
                reservations.splice(index, 1);
                renderReservations();
            }
        }

        function showAddSlotForm() {
            document.getElementById('add-slot-form').style.display = 'block';
        }

        function addAvailableSlot() {
            const slotDatetime = document.getElementById('slot-datetime').value;
            if (slotDatetime) {
                availableSlots.push(slotDatetime);
                renderAvailableSlots();
                document.getElementById('add-slot-form').style.display = 'none';
            }
        }

        function sendEmail(index, status) {
            const reservation = reservations[index];
            const email = reservation.extendedProps.email;
            const xhr = new XMLHttpRequest();
            xhr.open('POST', 'send_email.php', true); // Zamień na URL swojego skryptu PHP
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send(`email=${email}&status=${status}`);
            xhr.onload = function() {
                if (xhr.status === 200) {
                    alert(`Email o statusie rezerwacji został wysłany do ${email}`);
                } else {
                    alert('Wystąpił błąd podczas wysyłania emaila.');
                }
            };
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('add-event').addEventListener('click', function() {
                const name = document.getElementById('name').value;
                const phone = document.getElementById('phone').value;
                const email = document.getElementById('email').value;
                const service = document.getElementById('service').value;
                const comments = document.getElementById('comments').value;
                const datetime = document.getElementById('datetime').value;
                if (name && phone && email && service && datetime) {
                    const xhr = new XMLHttpRequest();
                    xhr.open('POST', 'send_email.php', true); // Zamień na URL swojego skryptu PHP
                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                    xhr.onload = function() {
                        if (xhr.status === 200) {
                            const eventData = {
                                title: name,
                                start: datetime,
                                extendedProps: {
                                    phone: phone,
                                    email: email,
                                    service: service,
                                    comments: comments
                                }
                            };
                            reservations.push(eventData);
                            $('#calendar').fullCalendar('renderEvent', eventData, true);
                            renderReservations();
                        } else {
                            alert('Wystąpił błąd podczas rezerwacji.');
                        }
                    };
                    xhr.send(`name=${name}&phone=${phone}&email=${email}&service=${service}&datetime=${datetime}&comments=${comments}`);
                }
            });
            fetchReservations();
        });
    </script>
</body>
</html>
